<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quiz Question Editor - Create and edit quiz questions compatible with Android app v2.11.2+">
    <title>Quiz Question Editor v0.8.0</title>

    <style>
        /* ==================== CSS VARIABLES ==================== */
        :root {
            --primary-color: #673AB7;
            --primary-dark: #320B86;
            --secondary-color: #FF9800;
            --background-color: #F5F5F5;
            --surface-color: #FFFFFF;
            --error-color: #F44336;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border-color: #E0E0E0;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 8px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 16px rgba(0,0,0,0.14);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --transition: all 0.3s ease;
        }

        /* ==================== RESET ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ==================== LANGUAGE SWITCHER ==================== */
        .language-switcher {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1000;
            background-color: var(--surface-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            padding: 0.5rem;
            display: flex;
            gap: 0.5rem;
        }

        .lang-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: transparent;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .lang-btn:hover {
            border-color: var(--primary-color);
            background-color: rgba(103, 58, 183, 0.1);
        }

        .lang-btn.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* ==================== LAYOUT ==================== */
        #app {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background-color: var(--surface-color);
            box-shadow: var(--shadow-sm);
            padding: 1rem;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
            transition: var(--transition);
        }

        .sidebar-header {
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        .sidebar-version {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .nav-menu {
            list-style: none;
            flex: 1;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .nav-link:hover {
            background-color: rgba(103, 58, 183, 0.1);
        }

        .nav-link.active {
            background-color: var(--primary-color);
            color: white;
        }

        .nav-icon {
            margin-right: 0.75rem;
            font-size: 1.25rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 2rem;
            transition: var(--transition);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* ==================== TYPOGRAPHY ==================== */
        h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* ==================== CARDS ==================== */
        .card {
            background-color: var(--surface-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* ==================== BUTTONS ==================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            gap: 0.5rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            box-shadow: var(--shadow-md);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: rgba(103, 58, 183, 0.1);
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
        }

        .btn-danger:hover {
            box-shadow: var(--shadow-md);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.125rem;
        }

        .btn-icon {
            padding: 0.5rem;
            font-size: 1.25rem;
        }

        /* ==================== INPUTS ==================== */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(103, 58, 183, 0.1);
        }

        .form-control:disabled {
            background-color: var(--background-color);
            cursor: not-allowed;
        }

        select.form-control {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23757575' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* ==================== BADGES ==================== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .badge-primary {
            background-color: rgba(103, 58, 183, 0.1);
            color: var(--primary-color);
        }

        .badge-secondary {
            background-color: rgba(255, 152, 0, 0.1);
            color: var(--secondary-color);
        }

        .badge-success {
            background-color: rgba(76, 175, 80, 0.1);
            color: var(--success-color);
        }

        .badge-danger {
            background-color: rgba(244, 67, 54, 0.1);
            color: var(--error-color);
        }

        /* ==================== TOAST NOTIFICATIONS ==================== */
        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            max-width: 400px;
        }

        .toast {
            background-color: var(--surface-color);
            border-left: 4px solid var(--primary-color);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: 1rem 1.5rem;
            margin-bottom: 0.75rem;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toast.success {
            border-color: var(--success-color);
        }

        .toast.error {
            border-color: var(--error-color);
        }

        .toast.warning {
            border-color: var(--warning-color);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .toast-message {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .toast-close {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* ==================== EMPTY STATE ==================== */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .empty-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        /* ==================== FILTERS TOOLBAR ==================== */
        .filters-toolbar {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            box-shadow: var(--shadow-sm);
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .filter-controls {
            display: flex;
            gap: 0.5rem;
        }

        .filter-input-wrapper {
            display: flex;
            gap: 0.5rem;
        }

        .filter-input-wrapper input {
            flex: 1;
        min-width: 200px;
        }

        .filter-chips-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 0.25rem;
            background-color: var(--background-color);
            border-radius: var(--radius-sm);
            min-height: 40px;
            align-items: center;
        }

        .filter-chip {
            background-color: white;
            border: 2px solid var(--border-color);
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .filter-chip:hover {
            border-color: var(--primary-color);
            background-color: rgba(103, 58, 183, 0.15);
        }

        .filter-chip.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-chip-remove {
            background-color: var(--error-color);
            color: white;
            border-color: var(--error-color);
            margin-left: 0.5rem;
        }

        .filter-chip-remove:hover {
            background-color: rgba(244, 67, 54, 0.15);
        }

        /* ==================== UTILITIES ==================== */
        .hidden {
            display: none !important;
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .gap-4 {
            gap: 1rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .text-center {
            text-align: center;
        }

        /* ==================== QUESTIONS LIST ==================== */
        .questions-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .question-card {
            background-color: var(--surface-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            border: 2px solid transparent;
            transition: var(--transition);
            position: relative;
        }

        .question-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .question-card.single {
            border-left-color: #4CAF50;
        }

        .question-card.multiple {
            border-left-color: #2196F3;
        }

        .question-card.ordering {
            border-left-color: #FF9800;
        }

        .question-card.pairing {
            border-left-color: #9C27B0;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .question-type {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .question-text {
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .question-text img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-md);
            margin: 0.5rem 0;
        }

        .question-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .difficulty-stars {
            color: #FFC107;
            letter-spacing: 2px;
        }

        .question-options {
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .question-option {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .question-option:last-child {
            border-bottom: none;
        }

        .question-option-marker {
            font-weight: 600;
            min-width: 24px;
        }

        .question-option.correct {
            color: var(--success-color);
            font-weight: 600;
        }

        .question-pairs {
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .question-pair {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .question-pair:last-child {
            border-bottom: none;
        }

        .question-pair-left,
        .question-pair-right {
            flex: 1;
            padding: 0.5rem;
            background-color: var(--surface-color);
            border-radius: var(--radius-sm);
        }

        .question-pair-arrow {
            margin: 0 0.5rem;
            color: var(--text-secondary);
        }

        .question-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        .question-footer {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .question-explanation {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            padding: 0.75rem;
            background-color: var(--background-color);
            border-radius: var(--radius-md);
        }

        /* ==================== PAGINATION ==================== */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding: 1rem;
            background-color: var(--surface-color);
            border-radius: var(--radius-lg);
        }

        .pagination-info {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.5rem 1rem;
            background-color: var(--surface-color);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: var(--primary-color);
            background-color: rgba(103, 58, 183, 0.1);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* ==================== QUESTIONS STATS ==================== */
        .questions-stats {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .stat-card {
            background-color: var(--surface-color);
            border-radius: var(--radius-md);
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow-sm);
            flex: 1;
            min-width: 150px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .stat-icon {
            font-size: 2rem;
            opacity: 0.7;
        }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .stat-card.single {
            border-left: 4px solid #4CAF50;
        }

        .stat-card.multiple {
            border-left: 4px solid #2196F3;
        }

        .stat-card.ordering {
            border-left: 4px solid #FF9800;
        }

        .stat-card.pairing {
            border-left: 4px solid #9C27B0;
        }

        /* ==================== IMAGE THUMBNAIL ==================== */
        .question-image {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: var(--radius-md);
            margin-bottom: 1rem;
        }

        .question-image-placeholder {
            width: 100%;
            height: 100px;
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .sidebar-toggle {
                display: block;
            }
        }

        @media (min-width: 769px) {
            .sidebar-toggle {
                display: none;
            }
        }

        /* ==================== ICONS (using Unicode for now) ==================== */
        .icon {
            display: inline-block;
            font-style: normal;
        }

        /* ==================== EDITOR FORM ==================== */
        .editor-form {
            padding: 1.5rem;
        }

        .required {
            color: var(--error-color);
        }

        .form-divider {
            border: none;
            border-top: 1px solid var(--border-color);
            margin: 1.5rem 0;
        }

        .error-message {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            min-height: 1.25rem;
        }

        .difficulty-selector {
            display: flex;
            gap: 0.5rem;
        }

        .difficulty-btn {
            padding: 0.5rem 1rem;
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.25rem;
        }

        .difficulty-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .difficulty-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
        }

        .tag-chip-remove {
            cursor: pointer;
            font-weight: bold;
        }

        .tag-chip-remove:hover {
            color: var(--background-color);
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .option-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .option-text {
            flex: 1;
        }

        .option-remove {
            padding: 0.25rem 0.5rem;
            background-color: var(--error-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
        }

        .option-remove:hover {
            background-color: rgba(244, 67, 54, 0.8);
        }

        .option-move {
            padding: 0.25rem 0.5rem;
            background-color: var(--border-color);
            color: var(--text-primary);
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
        }

        .option-move:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .pair-item {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .pair-remove {
            padding: 0.25rem 0.5rem;
            background-color: var(--error-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
        }

        .pair-remove:hover {
            background-color: rgba(244, 67, 54, 0.8);
        }

        .image-upload-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .image-upload-container {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .image-preview {
            width: 200px;
            height: 200px;
            border-radius: var(--radius-md);
            border: 2px dashed var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--background-color);
            overflow: hidden;
            position: relative;
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .image-preview-placeholder {
            color: var(--text-secondary);
            text-align: center;
            padding: 1rem;
        }

        .image-preview-placeholder span {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .image-upload-controls {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .image-upload-btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
        }

        .image-upload-btn:hover {
            background-color: var(--primary-dark);
        }

        .image-upload-input {
            display: none;
        }

        .image-remove-btn {
            display: none;
            padding: 0.5rem 1rem;
            background-color: var(--error-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .image-remove-btn:hover {
            background-color: rgba(244, 67, 54, 0.8);
        }

        .image-remove-btn.visible {
            display: inline-block;
        }

        .image-info {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .image-error {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        .editor-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            align-items: start;
        }

        .preview-section {
            position: sticky;
            top: 2rem;
            background-color: var(--background-color);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 2px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .preview-header {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .preview-card {
            background-color: var(--surface-color);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
        }

        .preview-type {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            padding: 0.5rem;
            background-color: var(--background-color);
            border-radius: var(--radius-sm);
        }

        .preview-question-text {
            font-size: 1.125rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .preview-image {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: var(--radius-md);
            margin-bottom: 1rem;
            display: none;
        }

        .preview-image.visible {
            display: block;
        }

        .preview-options {
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .preview-option {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .preview-option:last-child {
            border-bottom: none;
        }

        .preview-option-marker {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            flex-shrink: 0;
        }

        .preview-option.single.correct .preview-option-marker,
        .preview-option.multiple.correct .preview-option-marker {
            background-color: var(--success-color);
            color: white;
        }

        .preview-option.correct {
            color: var(--success-color);
            font-weight: 600;
        }

        .preview-pairs {
            background-color: var(--background-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .preview-pair {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: center;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }

        .preview-pair:last-child {
            border-bottom: none;
        }

        .preview-pair-left,
        .preview-pair-right {
            padding: 0.5rem;
            background-color: var(--surface-color);
            border-radius: var(--radius-sm);
            text-align: center;
        }

        .preview-pair-arrow {
            color: var(--text-secondary);
            font-size: 1.25rem;
        }

        .preview-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .preview-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .preview-badge.category {
            background-color: var(--primary-color);
            color: white;
        }

        .preview-badge.tag {
            background-color: var(--background-color);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .preview-explanation {
            background-color: #FFF3CD;
            border-left: 4px solid #FFC107;
            padding: 1rem;
            border-radius: var(--radius-sm);
            margin-top: 1rem;
        }

        .preview-explanation strong {
            color: #856404;
        }

        .preview-empty {
            text-align: center;
            color: var(--text-secondary);
            padding: 2rem;
        }

        .preview-empty span {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 1200px) {
            .editor-layout {
                grid-template-columns: 1fr;
            }

            .preview-section {
                position: static;
                order: -1;
            }
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="lang-btn active" id="lang-pl" onclick="app.setLanguage('pl')">
            üáµüá± PL
        </button>
        <button class="lang-btn" id="lang-en" onclick="app.setLanguage('en')">
            üá¨üáß EN
        </button>
    </div>

    <div id="app">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">Quiz Editor</h1>
                    <span class="sidebar-version">v0.8</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-page="questions">
                        <span class="nav-icon">üìã</span>
                        Pytania
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="create">
                        <span class="nav-icon">‚ûï</span>
                        Nowe pytanie
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="import-export">
                        <span class="nav-icon">üì•</span>
                        Import/Export
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-page="help">
                        <span class="nav-icon">‚ùì</span>
                        Pomoc
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Questions Page -->
            <section id="questions-page" class="page active">
                <!-- Stats -->
                <div class="questions-stats" id="questions-stats">
                    <div class="stat-card single">
                        <span class="stat-icon">‚≠ï</span>
                        <div class="stat-info">
                            <div class="stat-value" id="stat-single">0</div>
                            <div class="stat-label">Single</div>
                        </div>
                    </div>
                    <div class="stat-card multiple">
                        <span class="stat-icon">‚òëÔ∏è</span>
                        <div class="stat-info">
                            <div class="stat-value" id="stat-multiple">0</div>
                            <div class="stat-label">Multiple</div>
                        </div>
                    </div>
                    <div class="stat-card ordering">
                        <span class="stat-icon">üî¢</span>
                        <div class="stat-info">
                            <div class="stat-value" id="stat-ordering">0</div>
                            <div class="stat-label">Ordering</div>
                        </div>
                    </div>
                    <div class="stat-card pairing">
                        <span class="stat-icon">üîó</span>
                        <div class="stat-info">
                            <div class="stat-value" id="stat-pairing">0</div>
                            <div class="stat-label">Pairing</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üìã</span>
                        <div class="stat-info">
                            <div class="stat-value" id="stat-total">0</div>
                            <div class="stat-label">Wszystkie</div>
                        </div>
                    </div>
                </div>

                <!-- Toolbar -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Lista pyta≈Ñ</h2>
                        <button class="btn btn-primary btn-sm" id="add-question-btn">
                            <span class="icon">‚ûï</span>
                            Nowe pytanie
                        </button>
                    </div>
                    <!-- Filters -->
                    <div class="filters-toolbar">
                         <div class="filter-group">
                             <label class="filter-label">üîç Szukaj</label>
                             <input type="text" class="form-control filter-search" id="filter-search" placeholder="Szukaj...">
                         </div>
                        <div class="filter-group">
                            <label class="filter-label">üìã Typ</label>
                            <select class="form-control" id="filter-type" onchange="app.onFilterTypeChange()">
                                <option value="all">Wszystkie</option>
                                <option value="single">Single Choice</option>
                                <option value="multiple">Multiple Choice</option>
                                <option value="ordering">Ordering</option>
                                <option value="pairing">Pairing</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">üìÅ Kategoria</label>
                            <select class="form-control" id="filter-category" onchange="app.onFilterCategoryChange()">
                                <option value="">Wszystkie</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">üè∑Ô∏è Tagi</label>
                            <div id="filter-tags-container"></div>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline btn-sm" id="reset-filters" onclick="app.resetFilters()">
                                üîÑ Reset filtr√≥w
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Questions List -->
                <div class="questions-list" id="questions-list">
                    <!-- Questions will be rendered here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state hidden" id="empty-state">
                    <div class="empty-icon">üìù</div>
                    <h3 class="empty-title">Brak pyta≈Ñ</h3>
                    <p>Rozpocznij od utworzenia pierwszego pytania lub zaimportuj je z pliku JSON.</p>
                    <button class="btn btn-primary mt-4" onclick="app.navigateTo('import-export')">
                        <span class="icon">üì•</span>
                        Importuj z pliku
                    </button>
                </div>

                <!-- Pagination -->
                <div class="pagination hidden" id="pagination">
                    <div class="pagination-info" id="pagination-info">
                        Wy≈õwietlane 0-0 z 0 pyta≈Ñ
                    </div>
                    <div class="pagination-controls" id="pagination-controls">
                        <!-- Pagination buttons will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Create Page -->
            <section id="create-page" class="page">
                <div class="editor-layout">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title" id="editor-title">Edytor pyta≈Ñ</h2>
                            <div class="flex gap-2">
                                <button class="btn btn-outline btn-sm" id="cancel-btn" onclick="app.closeEditor()">
                                    Anuluj
                                </button>
                                <button class="btn btn-outline btn-sm" id="save-new-btn" onclick="app.saveQuestion(true)">
                                    <span class="icon">‚ûï</span>
                                    Zapisz i nowy
                                </button>
                                <button class="btn btn-primary btn-sm" id="save-btn" onclick="app.saveQuestion(false)">
                                    <span class="icon">üíæ</span>
                                    Zapisz
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <form id="question-form" class="editor-form">
                                <input type="hidden" id="question-id" value="">

                                <div class="form-group">
                                    <label class="form-label" for="question-type">Typ pytania</label>
                                    <select class="form-control" id="question-type" onchange="app.onQuestionTypeChange()">
                                        <option value="single">Single Choice (jedna poprawna)</option>
                                        <option value="multiple">Multiple Choice (wiele poprawnych)</option>
                                        <option value="ordering">Ordering (kolejno≈õƒá)</option>
                                        <option value="pairing">Pairing (≈ÇƒÖczenie par)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="question-text">Tre≈õƒá pytania <span class="required">*</span></label>
                                    <textarea class="form-control" id="question-text" rows="3" placeholder="Wprowad≈∫ tre≈õƒá pytania..." oninput="app.updatePreview()"></textarea>
                                    <div class="error-message" id="error-question-text"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="question-category">Kategoria <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="question-category" placeholder="np. Matematyka, Historia..." oninput="app.updatePreview()">
                                    <div class="error-message" id="error-question-category"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="question-tags">Tagi</label>
                                    <input type="text" class="form-control" id="question-tags-input" placeholder="Wprowad≈∫ tag i naci≈õnij Enter">
                                    <div class="tags-container" id="question-tags-container">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="question-difficulty">Poziom trudno≈õci</label>
                                    <div class="difficulty-selector" id="difficulty-selector">
                                        <button type="button" class="difficulty-btn" data-value="1">‚òÖ</button>
                                        <button type="button" class="difficulty-btn" data-value="2">‚òÖ‚òÖ</button>
                                        <button type="button" class="difficulty-btn" data-value="3">‚òÖ‚òÖ‚òÖ</button>
                                        <button type="button" class="difficulty-btn" data-value="4">‚òÖ‚òÖ‚òÖ‚òÖ</button>
                                        <button type="button" class="difficulty-btn" data-value="5">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</button>
                                    </div>
                                    <input type="hidden" id="question-difficulty" value="1">
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="question-explanation">Wyja≈õnienie (opcjonalne)</label>
                                    <textarea class="form-control" id="question-explanation" rows="2" placeholder="Wprowad≈∫ wyja≈õnienie..." oninput="app.updatePreview()"></textarea>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Obraz (opcjonalne)</label>
                                    <div class="image-upload-section">
                                        <div class="image-upload-container">
                                            <div class="image-preview" id="image-preview">
                                                <div class="image-preview-placeholder" id="image-preview-placeholder">
                                                    <span>üì∑</span>
                                                    Brak obrazu
                                                </div>
                                                <img id="image-preview-img" src="" alt="PodglƒÖd obrazu" style="display: none;">
                                            </div>
                                            <div class="image-upload-controls">
                                                <label class="image-upload-btn" for="image-upload-input">
                                                    üì§ Wybierz obraz
                                                </label>
                                                <input type="file" class="image-upload-input" id="image-upload-input" accept="image/jpeg,image/png,image/gif" onchange="app.uploadImage(this)">
                                                <button type="button" class="image-remove-btn" id="image-remove-btn" onclick="app.removeImage()">
                                                    üóëÔ∏è Usu≈Ñ obraz
                                                </button>
                                                <div class="image-info" id="image-info">
                                                    Akceptowane formaty: JPG, PNG, GIF. Maksymalny rozmiar: 1MB.
                                                </div>
                                                <div class="image-error" id="image-error"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="question-image" value="">
                                    </div>
                                </div>

                                <hr class="form-divider">

                                <div id="options-section">
                                    <div class="form-group">
                                        <label class="form-label">Opcje odpowiedzi</label>
                                        <div id="options-container">
                                        </div>
                                        <button type="button" class="btn btn-outline btn-sm mt-2" id="add-option-btn" onclick="app.addOption()">
                                            <span class="icon">‚ûï</span> Dodaj opcjƒô
                                        </button>
                                        <div class="error-message" id="error-options"></div>
                                    </div>
                                </div>

                                <div id="pairs-section" style="display: none;">
                                    <div class="form-group">
                                        <label class="form-label">Pary (dla typu Pairing)</label>
                                        <div id="pairs-container">
                                        </div>
                                        <button type="button" class="btn btn-outline btn-sm mt-2" id="add-pair-btn" onclick="app.addPair()">
                                            <span class="icon">‚ûï</span> Dodaj parƒô
                                        </button>
                                        <div class="error-message" id="error-pairs"></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="preview-section">
                        <div class="preview-header">PodglƒÖd pytania</div>
                        <div id="preview-content">
                            <div class="preview-empty">
                                <span>üëÅÔ∏è</span>
                                Wype≈Çnij formularz, aby zobaczyƒá podglƒÖd
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Import/Export Page -->
            <section id="import-export-page" class="page">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Import/Export</h2>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="import-label">Import pyta≈Ñ</label>
                        <input type="file" class="form-control" id="import-file" accept=".json">
                        <p class="text-secondary mt-4" id="import-description">Wybierz plik JSON z pytaniami do zaimportowania.</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="export-label">Eksport pyta≈Ñ</label>
                        <button class="btn btn-primary" id="export-btn">
                            <span class="icon">üì§</span>
                            Eksportuj do pliku
                        </button>
                        <p class="text-secondary mt-4" id="export-description">Eksportuje wszystkie pytania do formatu JSON v2.11.0.</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Schowek (Clipboard)</label>
                        <div class="flex gap-2">
                            <button class="btn btn-outline" onclick="app.exportToClipboard()">
                                <span class="icon">üìã</span>
                                Kopiuj do schowka
                            </button>
                            <button class="btn btn-outline" onclick="app.importFromClipboard()">
                                <span class="icon">üìã</span>
                                Wklej ze schowka
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Help Page -->
            <section id="help-page" class="page">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Pomoc</h2>
                    </div>
                    <h3>Quiz Question Editor v0.8.0</h3>
                    <p>
                        Aplikacja do tworzenia i edycji pyta≈Ñ quizowych, w pe≈Çni zgodna z aplikacjƒÖ Android v2.11.2+.
                    </p>
                    <h3>Obs≈Çugiwane typy pyta≈Ñ:</h3>
                    <ul>
                        <li>‚úÖ <strong>Single Choice</strong> - jedna poprawna odpowied≈∫</li>
                        <li>‚úÖ <strong>Multiple Choice</strong> - wiele poprawnych odpowiedzi</li>
                        <li>‚úÖ <strong>Ordering</strong> - u≈Ç√≥≈º w odpowiedniej kolejno≈õci</li>
                        <li>‚úÖ <strong>Pairing</strong> - ≈ÇƒÖcz pary</li>
                    </ul>
                    <h3>Funkcje:</h3>
                    <ul>
                        <li>‚úÖ Tworzenie pyta≈Ñ</li>
                        <li>‚è≥ Edycja pyta≈Ñ (w implementacji)</li>
                        <li>‚è≥ Dodawanie obraz√≥w (w implementacji)</li>
                        <li>‚è≥ Import/Export JSON (w implementacji)</li>
                        <li>‚è≥ Filtrowanie i wyszukiwanie (w implementacji)</li>
                    </ul>
                    <p class="text-secondary mt-4">
                        <strong>Status:</strong> Wersja 0.3.1 - lista pyta≈Ñ + i18n<br>
                        <strong>Postƒôp:</strong> 30% zrealizowanego planu
                    </p>
                </div>
            </section>
        </main>

        <!-- Toast Container -->
        <div class="toast-container" id="toast-container"></div>
    </div>

    <script>
        // ==================== STRING PROTOTYPE EXTENSIONS ====================
        String.prototype.isEmpty = function() {
            return this.trim().length === 0;
        };

        // ==================== APP STATE ====================
        const AppState = {
            currentPage: 'questions',
            questions: [],
            version: '0.8.0',
            currentPageIndex: 0,
            itemsPerPage: 50,
            language: 'pl',
            // Editor state
            editingQuestionId: null,
            editingImageData: null,
            // Filters
            filterSearch: '',
            filterType: 'all',
            filterCategory: '',
            filterTags: []
        };

        // ==================== TRANSLATIONS ====================
        const Translations = {
            pl: {
                // Navigation
                nav_questions: 'Pytania',
                nav_create: 'Nowe pytanie',
                nav_import_export: 'Import/Export',
                nav_help: 'Pomoc',

                // Questions page
                stats_single: 'Single',
                stats_multiple: 'Multiple',
                stats_ordering: 'Ordering',
                stats_pairing: 'Pairing',
                stats_total: 'Wszystkie',
                list_title: 'Lista pyta≈Ñ',
                add_question: 'Nowe pytanie',
                empty_title: 'Brak pyta≈Ñ',
                empty_text: 'Rozpocznij od utworzenia pierwszego pytania lub zaimportuj je z pliku JSON.',
                import_btn: 'Importuj z pliku',

                // Question cards
                type_single: 'Single Choice',
                type_multiple: 'Multiple Choice',
                type_ordering: 'Ordering',
                type_pairing: 'Pairing',
                edit_btn: 'Edytuj',
                copy_btn: 'Kopiuj',
                delete_btn: 'Usu≈Ñ',
                difficulty_tooltip: 'Poziom trudno≈õci',
                no_category: 'Bez kategorii',
                explanation_label: 'Wyja≈õnienie:',

                // Pagination
                showing: 'Wy≈õwietlane',
                of: 'z',
                questions: 'pyta≈Ñ',
                prev_btn: 'Wstecz',
                next_btn: 'Dalej',

                // Create page
                editor_title_new: 'Nowe pytanie',
                editor_title_edit: 'Edytuj pytanie',
                cancel_btn: 'Anuluj',
                save_btn: 'Zapisz',
                save_new_btn: 'Zapisz i nowy',
                impl_warning: 'W implementacji',
                impl_text: 'Edytor pyta≈Ñ jest w trakcie implementacji.',
                status_0_5_0: 'Wersja 0.5.0 - edytor pyta≈Ñ basic',
                progress_0_5_0: 'Postƒôp: 50% zrealizowanego planu',
                status_0_6_0: 'Wersja 0.6.0 - obs≈Çuga obraz√≥w',
                progress_0_6_0: 'Postƒôp: 60% zrealizowanego planu',
                status_0_7_0: 'Wersja 0.7.0 - podglƒÖd na ≈ºywo',
                 progress_0_7_0: 'Postƒôp: 70% zrealizowanego planu',
                 status_0_8_0: 'Wersja 0.8.0 - kompletny Import/Export',
                 progress_0_8_0: 'Postƒôp: 80% zrealizowanego planu',
                 
                 // Editor form
                label_type: 'Typ pytania',
                label_text: 'Tre≈õƒá pytania',
                placeholder_text: 'Wprowad≈∫ tre≈õƒá pytania...',
                label_category: 'Kategoria',
                placeholder_category: 'np. Matematyka, Historia...',
                label_tags: 'Tagi',
                placeholder_tags: 'Wprowad≈∫ tag i naci≈õnij Enter',
                label_difficulty: 'Poziom trudno≈õci',
                label_explanation: 'Wyja≈õnienie (opcjonalne)',
                placeholder_explanation: 'Wprowad≈∫ wyja≈õnienie...',
                label_options: 'Opcje odpowiedzi',
                add_option: 'Dodaj opcjƒô',
                remove_option: 'Usu≈Ñ',
                option_placeholder: 'Opcja...',
                label_correct: 'Poprawna odpowied≈∫',
                label_pairs: 'Pary (tylko dla pairing)',
                add_pair: 'Dodaj parƒô',
                pair_left: 'Lewa strona',
                pair_right: 'Prawa strona',
                
                // Validation
                error_text_required: 'Tre≈õƒá pytania jest wymagana',
                error_category_required: 'Kategoria jest wymagana',
                error_min_options: 'Minimum 2 opcje sƒÖ wymagane',
                error_min_correct: 'Minimum 1 poprawna odpowied≈∫ jest wymagana',
                error_min_pairs: 'Minimum 1 para jest wymagana',
                question_saved: 'Pytanie zosta≈Ço zapisane',
                question_updated: 'Pytanie zosta≈Ço zaktualizowane',

                 // Import/Export
                 import_title: 'Import pyta≈Ñ',
                 import_label: 'Wybierz plik JSON z pytaniami do zaimportowania.',
                 export_title: 'Eksport pyta≈Ñ',
                 export_btn: 'Eksportuj do pliku',
                 export_text: 'Eksportuje wszystkie pytania do formatu JSON v2.11.0.',
                 export_success: 'Pytania zosta≈Çy wyeksportowane!',
                 import_success: 'Zaimportowano {count} pyta≈Ñ!',
                 import_merge_confirm: 'Znaleziono {count} pyta≈Ñ do zaimportowania. Czy chcesz do≈ÇƒÖczyƒá je do istniejƒÖcych (Merge) czy zamieniƒá (Replace)?',
                 import_merge_success: 'Zaimportowano {count} pyta≈Ñ (merge)!',
                 import_cancelled: 'Import zosta≈Ç anulowany.',
                 import_error_invalid: 'Nieprawid≈Çowy format pliku JSON.',
                 import_error_no_questions: 'Nie znaleziono pyta≈Ñ w pliku.',
                 import_error_no_valid: 'Nie znaleziono prawid≈Çowych pyta≈Ñ w pliku.',
                 clipboard_copy_success: 'Skopiowano do schowka!',
                 clipboard_copy_failed: 'Nie uda≈Ço siƒô skopiowaƒá do schowka.',
                 clipboard_read_failed: 'Nie uda≈Ço siƒô odczytaƒá ze schowka.',
                 
                 // Help page
                 help_title: 'Pomoc',
                 app_version: 'Quiz Question Editor v0.8.0',
                 app_desc: 'Aplikacja do tworzenia i edycji pyta≈Ñ quizowych, w pe≈Çni zgodna z aplikacjƒÖ Android v2.11.2+.',
                supported_types: 'Obs≈Çugiwane typy pyta≈Ñ:',
                type_single_desc: 'jedna poprawna odpowied≈∫',
                type_multiple_desc: 'wiele poprawnych odpowiedzi',
                type_ordering_desc: 'u≈Ç√≥≈º w odpowiedniej kolejno≈õci',
                type_pairing_desc: '≈ÇƒÖcz pary',
                features_title: 'Funkcje:',
                feature_create: 'Tworzenie pyta≈Ñ',
                feature_edit: 'Edycja pyta≈Ñ',
                feature_images: 'Dodawanie obraz√≥w',
                feature_import_export: 'Import/Export JSON',
                feature_filtering: 'Filtrowanie i wyszukiwanie',
                status_label: 'Status:',

                // Toast messages
                toast_success: 'Sukces',
                toast_warning: 'Ostrze≈ºenie',
                toast_error: 'B≈ÇƒÖd',

                // Actions
                copy_success: 'Pytanie zosta≈Ço skopiowane!',
                delete_success: 'Pytanie zosta≈Ço usuniƒôte!',
                delete_confirm: 'Czy na pewno chcesz usunƒÖƒá to pytanie?',

                // Stats
                questions_count: 'pyta≈Ñ'
            },
            en: {
                // Navigation
                nav_questions: 'Questions',
                nav_create: 'New Question',
                nav_import_export: 'Import/Export',
                nav_help: 'Help',

                // Questions page
                stats_single: 'Single',
                stats_multiple: 'Multiple',
                stats_ordering: 'Ordering',
                stats_pairing: 'Pairing',
                stats_total: 'All',
                list_title: 'Questions List',
                add_question: 'New Question',
                empty_title: 'No Questions',
                empty_text: 'Start by creating your first question or import them from a JSON file.',
                import_btn: 'Import from file',

                // Question cards
                type_single: 'Single Choice',
                type_multiple: 'Multiple Choice',
                type_ordering: 'Ordering',
                type_pairing: 'Pairing',
                edit_btn: 'Edit',
                copy_btn: 'Copy',
                delete_btn: 'Delete',
                difficulty_tooltip: 'Difficulty level',
                no_category: 'No category',
                explanation_label: 'Explanation:',

                // Pagination
                showing: 'Showing',
                of: 'of',
                questions: 'questions',
                prev_btn: 'Previous',
                next_btn: 'Next',

                // Create page
                editor_title_new: 'New Question',
                editor_title_edit: 'Edit Question',
                cancel_btn: 'Cancel',
                save_btn: 'Save',
                save_new_btn: 'Save & New',
                impl_warning: 'In Development',
                impl_text: 'Question editor is under development.',
                status_0_5_0: 'Version 0.5.0 - Question editor basic',
                progress_0_5_0: 'Progress: 50% of implementation plan',
                status_0_6_0: 'Version 0.6.0 - Image support',
                progress_0_6_0: 'Progress: 60% of implementation plan',
                status_0_7_0: 'Version 0.7.0 - Live preview',
                 progress_0_7_0: 'Progress: 70% of implementation plan',
                 status_0_8_0: 'Version 0.8.0 - Complete Import/Export',
                 progress_0_8_0: 'Progress: 80% of implementation plan',
                 
                 // Editor form
                label_type: 'Question type',
                label_text: 'Question text',
                placeholder_text: 'Enter question text...',
                label_category: 'Category',
                placeholder_category: 'e.g., Math, History...',
                label_tags: 'Tags',
                placeholder_tags: 'Enter tag and press Enter',
                label_difficulty: 'Difficulty level',
                label_explanation: 'Explanation (optional)',
                placeholder_explanation: 'Enter explanation...',
                label_options: 'Answer options',
                add_option: 'Add option',
                remove_option: 'Remove',
                option_placeholder: 'Option...',
                label_correct: 'Correct answer',
                label_pairs: 'Pairs (for pairing only)',
                add_pair: 'Add pair',
                pair_left: 'Left side',
                pair_right: 'Right side',
                
                // Validation
                error_text_required: 'Question text is required',
                error_category_required: 'Category is required',
                error_min_options: 'Minimum 2 options are required',
                error_min_correct: 'Minimum 1 correct answer is required',
                error_min_pairs: 'Minimum 1 pair is required',
                question_saved: 'Question saved successfully',
                question_updated: 'Question updated successfully',

                 // Import/Export
                 import_title: 'Import Questions',
                 import_label: 'Select JSON file with questions to import.',
                 export_title: 'Export Questions',
                 export_btn: 'Export to file',
                 export_text: 'Exports all questions to JSON v2.11.0 format.',
                 export_success: 'Questions exported successfully!',
                 import_success: 'Imported {count} questions!',
                 import_merge_confirm: 'Found {count} questions to import. Do you want to merge with existing (Merge) or replace all (Replace)?',
                 import_merge_success: 'Imported {count} questions (merge)!',
                 import_cancelled: 'Import was cancelled.',
                 import_error_invalid: 'Invalid JSON file format.',
                 import_error_no_questions: 'No questions found in file.',
                 import_error_no_valid: 'No valid questions found in file.',
                 clipboard_copy_success: 'Copied to clipboard!',
                 clipboard_copy_failed: 'Failed to copy to clipboard.',
                 clipboard_read_failed: 'Failed to read from clipboard.',
                 
                 // Help page
                 help_title: 'Help',
                 app_version: 'Quiz Question Editor v0.8.0',
                 app_desc: 'Application for creating and editing quiz questions, fully compatible with Android app v2.11.2+.',
                supported_types: 'Supported question types:',
                type_single_desc: 'one correct answer',
                type_multiple_desc: 'multiple correct answers',
                type_ordering_desc: 'arrange in correct order',
                type_pairing_desc: 'match pairs',
                features_title: 'Features:',
                feature_create: 'Create questions',
                feature_edit: 'Edit questions',
                feature_images: 'Add images',
                feature_import_export: 'Import/Export JSON',
                feature_filtering: 'Filtering and search',
                status_label: 'Status:',

                // Toast messages
                toast_success: 'Success',
                toast_warning: 'Warning',
                toast_error: 'Error',

                // Actions
                copy_success: 'Question copied successfully!',
                delete_success: 'Question deleted successfully!',
                delete_confirm: 'Are you sure you want to delete this question?',

                // Stats
                questions_count: 'questions'
            }
        };

        // ==================== QUESTION MODEL ====================
        class Question {
            constructor({
                id = null,
                type = 'single',
                text = '',
                explanation = '',
                options = [],
                correct = [],
                pairs = [],
                category = '',
                tags = [],
                imageData = '',
                difficulty = 1,
                markedForReview = false
            } = {}) {
                this.id = id || this.generateId();
                this.type = type;
                this.text = text;
                this.explanation = explanation;
                this.options = options;
                this.correct = correct;
                this.pairs = pairs.map(p => new PairItem(p));
                this.category = category;
                this.tags = tags;
                this.imageData = imageData;
                this.difficulty = difficulty;
                this.markedForReview = markedForReview;
            }

            // Generate unique ID using timestamp
            generateId() {
                return Date.now() + Math.random().toString(36).substr(2, 9);
            }

            // Check if question is valid
            get isValid() {
                if (!this.text || this.text.trim().isEmpty()) return false;
                if (!this.category || this.category.trim().isEmpty()) return false;

                switch (this.type) {
                    case 'single':
                    case 'multiple':
                    case 'ordering':
                        return this.options.length >= 2 && this.correct.length > 0;
                    case 'pairing':
                        return this.pairs.length > 0;
                    default:
                        return false;
                }
            }

            // Convert Question to JSON (export format)
            toJson() {
                const json = {
                    id: this.id,
                    type: this.type,
                    text: this.text,
                    category: this.category,
                    tags: this.tags,
                    difficulty: this.difficulty
                };

                if (this.explanation) {
                    json.explanation = this.explanation;
                }

                if (this.imageData) {
                    json.imageData = this.imageData;
                }

                if (this.markedForReview) {
                    json.markedForReview = true;
                }

                // For pairing questions, export pairs
                if (this.type === 'pairing') {
                    json.pairs = this.pairs.map(p => p.toJson());
                    json.options = [];
                    json.correct = [];
                } else {
                    // For single/multiple/ordering, export options and correct
                    json.options = this.options;
                    json.correct = this.correct; // 1-based indices
                }

                return json;
            }

            // Create Question from JSON (import format)
            static fromJson(json) {
                // Parse pairs if present
                let pairs = [];
                if (json.pairs && Array.isArray(json.pairs)) {
                    pairs = json.pairs.map(p => PairItem.fromJson(p));
                }

                // Parse options
                const options = json.options || [];

                // Parse correct - can be indices (numbers) or text (strings)
                const correct = json.correct || [];

                return new Question({
                    id: json.id,
                    type: json.type,
                    text: json.text,
                    explanation: json.explanation || '',
                    options: options,
                    correct: correct,
                    pairs: pairs,
                    category: json.category || '',
                    tags: json.tags || [],
                    imageData: json.imageData || '',
                    difficulty: json.difficulty || 1,
                    markedForReview: json.markedForReview || false
                });
            }
        }

        // ==================== PAIR ITEM MODEL ====================
        class PairItem {
            constructor({ left = '', right = '' } = {}) {
                this.left = left;
                this.right = right;
            }

            toJson() {
                return {
                    left: this.left,
                    right: this.right
                };
            }

            static fromJson(json) {
                return new PairItem({
                    left: json.left || '',
                    right: json.right || ''
                });
            }

            toString() {
                return `${this.left}::${this.right}`;
            }

            equals(other) {
                if (!other) return false;
                return this.left === other.left && this.right === other.right;
            }
        }

        // ==================== HELPER FUNCTIONS ====================
        const Helpers = {
            // Generate unique ID
            generateId() {
                return Date.now() + Math.random().toString(36).substr(2, 9);
            },

            // Convert 0-based index to 1-based
            toOneBased(index) {
                return index + 1;
            },

            // Convert 1-based index to 0-based
            toZeroBased(index) {
                return index - 1;
            },

            // Convert all indices in array from 0-based to 1-based
            convertToOneBased(indices) {
                return indices.map(i => this.toOneBased(i));
            },

            // Convert all indices in array from 1-based to 0-based
            convertToZeroBased(indices) {
                return indices.map(i => this.toZeroBased(i));
            },

            // Validate question type
            isValidQuestionType(type) {
                return ['single', 'multiple', 'ordering', 'pairing'].includes(type);
            },

            // Get question type emoji
            getQuestionTypeEmoji(type) {
                const emojis = {
                    'single': '‚≠ï',
                    'multiple': '‚òëÔ∏è',
                    'ordering': 'üî¢',
                    'pairing': 'üîó'
                };
                return emojis[type] || '‚ùì';
            },

            // File to base64
            fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                    reader.readAsDataURL(file);
                });
            },

            // Resize image using canvas
            resizeImage(dataUrl, maxWidth = 1024, maxHeight = 1024, quality = 0.85) {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;

                        // Calculate new dimensions maintaining aspect ratio
                        if (width > maxWidth || height > maxHeight) {
                            if (width / maxWidth > height / maxHeight) {
                                width = maxWidth;
                                height = (maxWidth / img.width) * img.height;
                            } else {
                                height = maxHeight;
                                width = (maxHeight / img.height) * img.width;
                            }
                        }

                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        resolve(canvas.toDataURL('image/jpeg', quality));
                    };
                    img.src = dataUrl;
                });
            },

            // Format date to ISO string
            formatDate(date) {
                return new Date(date).toISOString();
            },

            // Get current timestamp
            getTimestamp() {
                return Date.now();
            },

            // Sanitize HTML (basic)
            sanitizeHtml(html) {
                const div = document.createElement('div');
                div.textContent = html;
                return div.innerHTML;
            }
        };

        // ==================== APP CLASS ====================
        class QuizEditorApp {
            constructor() {
                this.init();
            }

            init() {
                console.log('Quiz Question Editor v0.8.0 - Initializing...');

                // Load language preference
                const savedLang = localStorage.getItem('language');
                if (savedLang && (savedLang === 'pl' || savedLang === 'en')) {
                    AppState.language = savedLang;
                    console.log('Language preference loaded from localStorage:', savedLang);
                    document.getElementById('lang-pl').classList.toggle('active', AppState.language === 'pl');
                    document.getElementById('lang-en').classList.toggle('active', AppState.language === 'en');
                } else {
                    console.log('No language preference found, using default: PL');
                    AppState.language = 'pl';
                }

                this.bindEvents();
                this.loadQuestions();
                this.updateAllText();
            }

            // ==================== EVENT BINDING ====================
            bindEvents() {
                // Navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = link.getAttribute('data-page');
                        if (page === 'create') {
                            this.openEditor();
                        } else {
                            this.navigateTo(page);
                        }
                    });
                });

                // Buttons
                document.getElementById('add-question-btn')?.addEventListener('click', () => {
                    this.openEditor();
                });

                // Export button
                document.getElementById('export-btn')?.addEventListener('click', () => {
                    this.exportQuestions();
                });

                // Difficulty selector
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.onDifficultyChange(parseInt(e.target.dataset.value));
                    });
                });

                // Tags input
                document.getElementById('question-tags-input')?.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        this.addTag(e.target.value);
                    }
                });

                // Import file
                document.getElementById('import-file')?.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            try {
                                const data = JSON.parse(event.target.result);
                                this.handleImport(data);
                            } catch (error) {
                                this.showToast('error', this.t('toast_error'), 'Import failed: ' + error.message);
                            }
                        };
                        reader.readAsText(file);
                    }
                });
            }

            // ==================== NAVIGATION ====================
            navigateTo(pageName) {
                AppState.currentPage = pageName;

                // Update nav links
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-page') === pageName) {
                        link.classList.add('active');
                    }
                });

                // Update pages
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });

                const targetPage = document.getElementById(`${pageName}-page`);
                if (targetPage) {
                    targetPage.classList.add('active');
                }

                console.log(`Navigated to: ${pageName}`);
            }

            // ==================== QUESTIONS ====================
            getFilteredQuestions() {
                return AppState.questions.filter(q => {
                    const matchesSearch = AppState.filterSearch === '' || 
                        q.text.toLowerCase().includes(AppState.filterSearch.toLowerCase()) ||
                        q.category.toLowerCase().includes(AppState.filterSearch.toLowerCase());

                    const matchesType = AppState.filterType === 'all' || q.type === AppState.filterType;

                    const matchesCategory = AppState.filterCategory === '' || q.category === AppState.filterCategory;

                    const matchesTags = AppState.filterTags.length === 0 || 
                        (q.tags && q.tags.some(tag => AppState.filterTags.includes(tag)));

                    return matchesSearch && matchesType && matchesCategory && matchesTags;
                });
            }

            loadQuestions() {
                const saved = localStorage.getItem('questions');
                if (saved) {
                    try {
                        AppState.questions = JSON.parse(saved);
                        console.log(`Loaded ${AppState.questions.length} questions`);
                    } catch (e) {
                        console.error('Error loading questions:', e);
                        AppState.questions = [];
                    }
                }
                this.updateUI();
            }

            saveQuestions() {
                localStorage.setItem('questions', JSON.stringify(AppState.questions));
            }

            // ==================== UI UPDATES ====================
            updateUI() {
                this.renderStats();
                this.renderQuestions();
                this.renderPagination();
                this.updateEmptyState();
                this.updateFiltersUI();
            }

            // ==================== RESET FILTERS ====================
            resetFilters() {
                console.log('resetFilters() called');
                AppState.filterSearch = '';
                AppState.filterType = 'all';
                AppState.filterCategory = '';
                AppState.filterTags = [];
                this.renderQuestions();
            }

            // ==================== UPDATE FILTERS UI ====================
            updateFiltersUI() {
                const t = Translations[AppState.language];

                // Update search input
                const searchInput = document.getElementById('filter-search');
                if (searchInput) {
                    searchInput.placeholder = t.search_placeholder;
                }

                // Update type dropdown
                const typeFilter = document.getElementById('filter-type');
                if (typeFilter) {
                    typeFilter.value = AppState.filterType;
                }

                // Update category dropdown (needs dynamic options)
                const categoryFilter = document.getElementById('filter-category');
                if (categoryFilter) {
                    // Get unique categories from questions
                    const categories = [...new Set(AppState.questions.map(q => q.category).filter(c => c && c.trim() !== ''))];
                    const currentValue = AppState.filterCategory;

                    // Clear existing options
                    categoryFilter.innerHTML = `<option value="">${t.filter_category_all}</option>`;

                    // Add "All" option
                    const allOption = document.createElement('option');
                    allOption.value = '';
                    allOption.textContent = t.filter_category_all;
                    categoryFilter.appendChild(allOption);

                    // Add category options
                    categories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        if (cat === currentValue) {
                            option.selected = true;
                        }
                        categoryFilter.appendChild(option);
                    });
                }

                // Update tags container
                const tagsContainer = document.getElementById('filter-tags-container');
                if (tagsContainer) {
                    this.renderFilterTags();
                }

                console.log('updateFiltersUI() completed');
            }

            // ==================== RENDER STATS ====================
            renderStats() {
                const stats = {
                    single: 0,
                    multiple: 0,
                    ordering: 0,
                    pairing: 0,
                    total: AppState.questions.length
                };

                AppState.questions.forEach(q => {
                    if (stats.hasOwnProperty(q.type)) {
                        stats[q.type]++;
                    }
                });

                document.getElementById('stat-single').textContent = stats.single;
                document.getElementById('stat-multiple').textContent = stats.multiple;
                document.getElementById('stat-ordering').textContent = stats.ordering;
                document.getElementById('stat-pairing').textContent = stats.pairing;
                document.getElementById('stat-total').textContent = stats.total;
            }

            // ==================== RENDER QUESTIONS ====================
            renderQuestions() {
                const container = document.getElementById('questions-list');
                if (!container) return;

                const filteredQuestions = this.getFilteredQuestions();

                // Get questions for current page
                const start = AppState.currentPageIndex * AppState.itemsPerPage;
                const end = start + AppState.itemsPerPage;
                const questions = filteredQuestions.slice(start, end);

                container.innerHTML = questions.map(q => this.renderQuestionCard(q)).join('');
            }

            // ==================== RENDER QUESTION CARD ====================
            renderQuestionCard(question) {
                const typeEmoji = Helpers.getQuestionTypeEmoji(question.type);
                const typeName = this.getQuestionTypeName(question.type);
                const stars = '‚òÖ'.repeat(question.difficulty || 1) + '‚òÜ'.repeat(5 - (question.difficulty || 1));

                let contentHtml = '';

                // Image thumbnail
                if (question.imageData) {
                    contentHtml += `<img src="${question.imageData}" class="question-image" alt="Question image">`;
                }

                // Question text
                contentHtml += `<div class="question-text">${question.text}</div>`;

                // Options for ordering
                if (question.type === 'ordering' && question.options && question.options.length > 0) {
                    contentHtml += `<div class="question-options">`;
                    question.options.forEach((opt, idx) => {
                        contentHtml += `
                            <div class="question-option">
                                <span class="question-option-marker">${idx + 1}.</span>
                                ${opt}
                            </div>
                        `;
                    });
                    contentHtml += `</div>`;
                }
                // Options for single/multiple
                else if (question.type !== 'pairing' && question.options && question.options.length > 0) {
                    contentHtml += `<div class="question-options">`;
                    question.options.forEach((opt, idx) => {
                        const isCorrect = question.correct && question.correct.includes(idx + 1);
                        const marker = String.fromCharCode(65 + idx); // A, B, C, D...
                        contentHtml += `
                            <div class="question-option ${isCorrect ? 'correct' : ''}">
                                <span class="question-option-marker">${marker}.</span>
                                ${opt}
                            </div>
                        `;
                    });
                    contentHtml += `</div>`;
                }

                // Pairs for pairing questions
                if (question.type === 'pairing' && question.pairs && question.pairs.length > 0) {
                    contentHtml += `<div class="question-pairs">`;
                    question.pairs.forEach(pair => {
                        contentHtml += `
                            <div class="question-pair">
                                <div class="question-pair-left">${pair.left}</div>
                                <span class="question-pair-arrow">‚Üí</span>
                                <div class="question-pair-right">${pair.right}</div>
                            </div>
                        `;
                    });
                    contentHtml += `</div>`;
                }

                // Tags and category
                const tagsHtml = question.tags && question.tags.length > 0
                    ? question.tags.map(tag => `<span class="badge badge-primary">${tag}</span>`).join('')
                    : '';

                return `
                    <div class="question-card ${question.type}" data-id="${question.id}">
                        <div class="question-header">
                            <div class="question-type">
                                <span class="icon">${typeEmoji}</span>
                                <span>${typeName}</span>
                            </div>
                            <div class="flex gap-2">
                                <button class="btn btn-outline btn-icon" onclick="app.editQuestion('${question.id}')" title="${this.t('edit_btn')}">
                                    ‚úèÔ∏è
                                </button>
                                <button class="btn btn-outline btn-icon" onclick="app.copyQuestion('${question.id}')" title="${this.t('copy_btn')}">
                                    üìã
                                </button>
                                <button class="btn btn-danger btn-icon" onclick="app.deleteQuestion('${question.id}')" title="${this.t('delete_btn')}">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>

                        ${contentHtml}

                        <div class="question-footer">
                            <div class="question-meta">
                                <div class="difficulty-stars" title="${this.t('difficulty_tooltip')}">${stars}</div>
                                <span class="badge badge-secondary">${question.category || this.t('no_category')}</span>
                                ${tagsHtml}
                            </div>
                            ${question.explanation ? `<div class="question-explanation"><strong>${this.t('explanation_label')}</strong> ${question.explanation}</div>` : ''}
                        </div>
                    </div>
                `;
            }

            // ==================== RENDER PAGINATION ====================
            renderPagination() {
                const t = Translations[AppState.language];
                const container = document.getElementById('pagination');
                const controls = document.getElementById('pagination-controls');
                const info = document.getElementById('pagination-info');

                if (!container) return;

                const filteredQuestions = this.getFilteredQuestions();

                if (filteredQuestions.length === 0) {
                    container.classList.add('hidden');
                    return;
                }

                container.classList.remove('hidden');

                const totalPages = Math.ceil(filteredQuestions.length / AppState.itemsPerPage);
                const start = AppState.currentPageIndex * AppState.itemsPerPage + 1;
                const end = Math.min(start + AppState.itemsPerPage - 1, filteredQuestions.length);

                info.textContent = `${t.showing} ${start}-${end} ${t.of} ${filteredQuestions.length} ${t.questions}`;

                // Render page buttons
                let buttonsHtml = '';

                // Previous button
                buttonsHtml += `
                    <button class="pagination-btn" ${AppState.currentPageIndex === 0 ? 'disabled' : ''} onclick="app.prevPage()">
                        ‚Üê ${t.prev_btn}
                    </button>
                `;

                // Page numbers
                for (let i = 0; i < totalPages; i++) {
                    const isActive = i === AppState.currentPageIndex;
                    buttonsHtml += `
                        <button class="pagination-btn ${isActive ? 'active' : ''}" onclick="app.goToPage(${i})">
                            ${i + 1}
                        </button>
                    `;
                }

                // Next button
                buttonsHtml += `
                    <button class="pagination-btn" ${AppState.currentPageIndex >= totalPages - 1 ? 'disabled' : ''} onclick="app.nextPage()">
                        ${t.next_btn} ‚Üí
                    </button>
                `;

                controls.innerHTML = buttonsHtml;
            }

            // ==================== UPDATE EMPTY STATE ====================
            updateEmptyState() {
                const emptyState = document.getElementById('empty-state');
                const questionsList = document.getElementById('questions-list');
                const pagination = document.getElementById('pagination');

                if (AppState.questions.length === 0) {
                    emptyState.classList.remove('hidden');
                    questionsList.classList.add('hidden');
                    pagination.classList.add('hidden');
                } else {
                    emptyState.classList.add('hidden');
                    questionsList.classList.remove('hidden');
                }
            }

            // ==================== PAGINATION ACTIONS ====================
            goToPage(pageIndex) {
                AppState.currentPageIndex = pageIndex;
                this.updateUI();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            nextPage() {
                const totalPages = Math.ceil(AppState.questions.length / AppState.itemsPerPage);
                if (AppState.currentPageIndex < totalPages - 1) {
                    this.goToPage(AppState.currentPageIndex + 1);
                }
            }

            prevPage() {
                if (AppState.currentPageIndex > 0) {
                    this.goToPage(AppState.currentPageIndex - 1);
                }
            }

            // ==================== QUESTION ACTIONS ====================
            editQuestion(id) {
                AppState.editingQuestionId = id;
                this.openEditor(id);
            }

            // ==================== EDITOR ====================
            openEditor(id = null) {
                const t = Translations[AppState.language];
                const isNew = id === null;

                this.navigateTo('create');

                if (isNew) {
                    AppState.editingQuestionId = null;
                    document.getElementById('editor-title').textContent = t.editor_title_new;
                    this.resetForm();
                } else {
                    AppState.editingQuestionId = id;
                    document.getElementById('editor-title').textContent = t.editor_title_edit;
                    this.loadQuestionToForm(id);
                }
            }

            closeEditor() {
                AppState.editingQuestionId = null;
                this.resetForm();
                this.navigateTo('questions');
            }

            resetForm() {
                document.getElementById('question-id').value = '';
                document.getElementById('question-type').value = 'single';
                document.getElementById('question-text').value = '';
                document.getElementById('question-category').value = '';
                document.getElementById('question-tags-input').value = '';
                document.getElementById('question-explanation').value = '';
                document.getElementById('question-difficulty').value = '1';
                document.getElementById('options-container').innerHTML = '';
                document.getElementById('pairs-container').innerHTML = '';
                document.getElementById('question-tags-container').innerHTML = '';
                this.clearErrors();
                this.setDifficulty(1);
                this.renderOptionsEditor();
                this.resetImage();
                this.updatePreview();
            }

            clearErrors() {
                document.getElementById('error-question-text').textContent = '';
                document.getElementById('error-question-category').textContent = '';
                document.getElementById('error-options').textContent = '';
                document.getElementById('error-pairs').textContent = '';
            }

            loadQuestionToForm(id) {
                const question = AppState.questions.find(q => q.id === id);
                if (!question) return;

                document.getElementById('question-id').value = question.id;
                document.getElementById('question-type').value = question.type;
                document.getElementById('question-text').value = question.text;
                document.getElementById('question-category').value = question.category;
                document.getElementById('question-explanation').value = question.explanation || '';
                document.getElementById('question-difficulty').value = question.difficulty || 1;

                this.setDifficulty(question.difficulty || 1);
                this.renderTags(question.tags || []);
                this.renderOptionsEditor(question);
                this.loadImage(question.imageData || null);
                this.updatePreview();
            }

            setDifficulty(value) {
                document.getElementById('question-difficulty').value = value;
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.classList.toggle('active', parseInt(btn.dataset.value) === value);
                });
            }

            renderTags(tags) {
                const container = document.getElementById('question-tags-container');
                container.innerHTML = '';
                tags.forEach(tag => {
                    const chip = document.createElement('div');
                    chip.className = 'tag-chip';
                    chip.innerHTML = `${tag} <span class="tag-chip-remove" onclick="app.removeTag('${tag}')">√ó</span>`;
                    container.appendChild(chip);
                });
            }

            onDifficultyChange(value) {
                this.setDifficulty(value);
            }

            onQuestionTypeChange() {
                this.renderOptionsEditor();
                this.updatePreview();
            }

            renderOptionsEditor(question = null) {
                const type = document.getElementById('question-type').value;
                const optionsSection = document.getElementById('options-section');
                const pairsSection = document.getElementById('pairs-section');
                const optionsContainer = document.getElementById('options-container');
                const pairsContainer = document.getElementById('pairs-container');

                if (type === 'pairing') {
                    optionsSection.style.display = 'none';
                    pairsSection.style.display = 'block';
                    this.renderPairsEditor(question ? question.pairs : []);
                } else {
                    optionsSection.style.display = 'block';
                    pairsSection.style.display = 'none';
                    this.renderOptionsList(question ? question.options : [], question ? question.correct : [], type);
                }
            }

            renderOptionsList(options, correct, type) {
                const container = document.getElementById('options-container');
                container.innerHTML = '';

                if (!options || options.length === 0) {
                    options = ['', ''];
                }

                options.forEach((option, index) => {
                    const isCorrect = correct.includes(index + 1);
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option-item';

                    const textInput = document.createElement('input');
                    textInput.type = 'text';
                    textInput.className = 'form-control option-text';
                    textInput.value = option;
                    textInput.placeholder = this.t('option_placeholder') + ' ' + (index + 1);
                    textInput.onchange = (e) => this.updateOption(index, e.target.value);

                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.className = 'option-remove';
                    removeBtn.textContent = '√ó';
                    removeBtn.onclick = () => this.removeOption(index);

                    const moveUpBtn = document.createElement('button');
                    moveUpBtn.type = 'button';
                    moveUpBtn.className = 'option-move';
                    moveUpBtn.textContent = '‚Üë';
                    moveUpBtn.onclick = () => this.moveOption(index, -1);

                    const moveDownBtn = document.createElement('button');
                    moveDownBtn.type = 'button';
                    moveDownBtn.className = 'option-move';
                    moveDownBtn.textContent = '‚Üì';
                    moveDownBtn.onclick = () => this.moveOption(index, 1);

                    if (type !== 'ordering') {
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.className = 'option-checkbox';
                        checkbox.checked = isCorrect;
                        checkbox.onchange = () => this.toggleCorrect(index);
                        optionDiv.appendChild(checkbox);
                    }

                    optionDiv.appendChild(textInput);

                    if (type === 'ordering') {
                        optionDiv.appendChild(moveUpBtn);
                        optionDiv.appendChild(moveDownBtn);
                    }

                    optionDiv.appendChild(removeBtn);
                    container.appendChild(optionDiv);
                });
            }

            renderPairsEditor(pairs) {
                const container = document.getElementById('pairs-container');
                container.innerHTML = '';

                if (!pairs || pairs.length === 0) {
                    pairs = [{ left: '', right: '' }];
                }

                pairs.forEach((pair, index) => {
                    this.renderPairItem(index, pair);
                });
            }

            renderPairItem(index, pair) {
                const container = document.getElementById('pairs-container');
                const pairDiv = document.createElement('div');
                pairDiv.className = 'pair-item';

                const leftInput = document.createElement('input');
                leftInput.type = 'text';
                leftInput.className = 'form-control';
                leftInput.value = pair.left || '';
                leftInput.placeholder = this.t('pair_left') + ' ' + (index + 1);
                leftInput.onchange = (e) => this.updatePairLeft(index, e.target.value);

                const rightInput = document.createElement('input');
                rightInput.type = 'text';
                rightInput.className = 'form-control';
                rightInput.value = pair.right || '';
                rightInput.placeholder = this.t('pair_right') + ' ' + (index + 1);
                rightInput.onchange = (e) => this.updatePairRight(index, e.target.value);

                const removeBtn = document.createElement('button');
                removeBtn.type = 'button';
                removeBtn.className = 'pair-remove';
                removeBtn.textContent = '√ó';
                removeBtn.onclick = () => this.removePair(index);

                pairDiv.appendChild(leftInput);
                pairDiv.appendChild(rightInput);
                pairDiv.appendChild(removeBtn);
                container.appendChild(pairDiv);
            }

            addOption() {
                const container = document.getElementById('options-container');
                const options = container.querySelectorAll('.option-text');
                this.renderOptionsList(
                    Array.from(options).map(input => input.value).concat(['']),
                    this.getCorrectFromForm(),
                    document.getElementById('question-type').value
                );
                this.updatePreview();
            }

            removeOption(index) {
                const container = document.getElementById('options-container');
                const options = container.querySelectorAll('.option-text');
                const optionsValues = Array.from(options).map(input => input.value);
                optionsValues.splice(index, 1);

                const correct = this.getCorrectFromForm();
                const newCorrect = correct.filter(c => c !== index + 1).map(c => c > index + 1 ? c - 1 : c);

                this.renderOptionsList(optionsValues, newCorrect, document.getElementById('question-type').value);
                this.updatePreview();
            }

            moveOption(index, direction) {
                const container = document.getElementById('options-container');
                const options = container.querySelectorAll('.option-text');
                const optionsValues = Array.from(options).map(input => input.value);
                const newIndex = index + direction;

                if (newIndex < 0 || newIndex >= optionsValues.length) return;

                const temp = optionsValues[index];
                optionsValues[index] = optionsValues[newIndex];
                optionsValues[newIndex] = temp;

                this.renderOptionsList(optionsValues, this.getCorrectFromForm(), document.getElementById('question-type').value);
                this.updatePreview();
            }

            updateOption(index, value) {
                this.updatePreview();
            }

            toggleCorrect(index) {
                const type = document.getElementById('question-type').value;
                const checkboxes = document.querySelectorAll('.option-checkbox');
                const checkbox = checkboxes[index];

                if (type === 'single' && checkbox.checked) {
                    checkboxes.forEach((cb, idx) => {
                        if (idx !== index) {
                            cb.checked = false;
                        }
                    });
                }

                this.updatePreview();
            }

            getCorrectFromForm() {
                const type = document.getElementById('question-type').value;
                const checkboxes = document.querySelectorAll('.option-checkbox');
                const correct = [];

                checkboxes.forEach((checkbox, index) => {
                    if (checkbox.checked) {
                        correct.push(index + 1);
                    }
                });

                return correct;
            }

            addPair() {
                const container = document.getElementById('pairs-container');
                const pairs = container.querySelectorAll('.pair-item');
                const pairsData = [];

                pairs.forEach(pairDiv => {
                    const inputs = pairDiv.querySelectorAll('input');
                    pairsData.push({
                        left: inputs[0].value,
                        right: inputs[1].value
                    });
                });

                pairsData.push({ left: '', right: '' });
                container.innerHTML = '';
                pairsData.forEach((pair, index) => this.renderPairItem(index, pair));
                this.updatePreview();
            }

            removePair(index) {
                const container = document.getElementById('pairs-container');
                const pairs = container.querySelectorAll('.pair-item');
                const pairsData = [];

                pairs.forEach(pairDiv => {
                    const inputs = pairDiv.querySelectorAll('input');
                    pairsData.push({
                        left: inputs[0].value,
                        right: inputs[1].value
                    });
                });

                pairsData.splice(index, 1);
                container.innerHTML = '';
                pairsData.forEach((pair, i) => this.renderPairItem(i, pair));
                this.updatePreview();
            }

            updatePairLeft(index, value) {
                this.updatePreview();
            }

            updatePairRight(index, value) {
                this.updatePreview();
            }

            addTag(tag) {
                const container = document.getElementById('question-tags-container');
                const tags = Array.from(container.querySelectorAll('.tag-chip')).map(chip =>
                    chip.textContent.replace('√ó', '').trim()
                );

                if (!tags.includes(tag) && tag.trim() !== '') {
                    const chip = document.createElement('div');
                    chip.className = 'tag-chip';
                    chip.innerHTML = `${tag} <span class="tag-chip-remove" onclick="app.removeTag('${tag}')">√ó</span>`;
                    container.appendChild(chip);
                }

                document.getElementById('question-tags-input').value = '';
                this.updatePreview();
            }

            removeTag(tag) {
                const container = document.getElementById('question-tags-container');
                const chips = container.querySelectorAll('.tag-chip');
                chips.forEach(chip => {
                    if (chip.textContent.includes(tag)) {
                        chip.remove();
                    }
                });
                this.updatePreview();
            }

            uploadImage(input) {
                const file = input.files[0];
                if (!file) {
                    return;
                }

                const errorElement = document.getElementById('image-error');
                const infoElement = document.getElementById('image-info');

                errorElement.textContent = '';

                const maxSize = 1 * 1024 * 1024;
                if (file.size > maxSize) {
                    errorElement.textContent = 'Plik jest za du≈ºy. Maksymalny rozmiar to 1MB.';
                    input.value = '';
                    return;
                }

                const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
                if (!allowedTypes.includes(file.type)) {
                    errorElement.textContent = 'Nieobs≈Çugiwany format. Dozwolone: JPG, PNG, GIF.';
                    input.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const resizedImageData = this.resizeImage(img, 1024, 1024, 0.85);
                        AppState.editingImageData = resizedImageData;
                        this.renderImagePreview(resizedImageData);
                        infoElement.textContent = `Rozmiar: ${Math.round(resizedImageData.length / 1024)}KB`;
                        input.value = '';
                        this.updatePreview();
                    };
                    img.onerror = () => {
                        errorElement.textContent = 'B≈ÇƒÖd podczas ≈Çadowania obrazu.';
                        input.value = '';
                    };
                    img.src = e.target.result;
                };
                reader.onerror = () => {
                    errorElement.textContent = 'B≈ÇƒÖd podczas odczytu pliku.';
                    input.value = '';
                };
                reader.readAsDataURL(file);
            }

            removeImage() {
                this.resetImage();
                this.updatePreview();
            }

            loadImage(imageData) {
                if (imageData) {
                    AppState.editingImageData = imageData;
                    this.renderImagePreview(imageData);
                    document.getElementById('image-info').textContent = `Rozmiar: ${Math.round(imageData.length / 1024)}KB`;
                } else {
                    this.resetImage();
                }
                this.updatePreview();
            }

            resetImage() {
                AppState.editingImageData = null;
                document.getElementById('question-image').value = '';
                document.getElementById('image-upload-input').value = '';
                document.getElementById('image-info').textContent = 'Akceptowane formaty: JPG, PNG, GIF. Maksymalny rozmiar: 1MB.';
                document.getElementById('image-error').textContent = '';
                this.renderImagePreview(null);
                this.updatePreview();
            }

            renderImagePreview(imageData) {
                const previewImg = document.getElementById('image-preview-img');
                const previewPlaceholder = document.getElementById('image-preview-placeholder');
                const removeBtn = document.getElementById('image-remove-btn');

                if (imageData) {
                    previewImg.src = imageData;
                    previewImg.style.display = 'block';
                    previewPlaceholder.style.display = 'none';
                    removeBtn.classList.add('visible');
                } else {
                    previewImg.style.display = 'none';
                    previewPlaceholder.style.display = 'block';
                    removeBtn.classList.remove('visible');
                }
            }

            resizeImage(img, maxWidth, maxHeight, quality) {
                let width = img.width;
                let height = img.height;

                if (width > maxWidth || height > maxHeight) {
                    const ratio = Math.min(maxWidth / width, maxHeight / height);
                    width = Math.floor(width * ratio);
                    height = Math.floor(height * ratio);
                }

                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;

                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);

                return canvas.toDataURL('image/jpeg', quality);
            }

            updatePreview() {
                const previewContent = document.getElementById('preview-content');
                if (!previewContent) return;

                const type = document.getElementById('question-type').value;
                const text = document.getElementById('question-text').value.trim();
                const category = document.getElementById('question-category').value.trim();
                const difficulty = parseInt(document.getElementById('question-difficulty').value);
                const explanation = document.getElementById('question-explanation').value.trim();
                const tagsContainer = document.getElementById('question-tags-container');
                const tags = Array.from(tagsContainer.querySelectorAll('.tag-chip')).map(chip =>
                    chip.textContent.replace('√ó', '').trim()
                );

                if (!text && !category) {
                    previewContent.innerHTML = `
                        <div class="preview-empty">
                            <span>üëÅÔ∏è</span>
                            Wype≈Çnij formularz, aby zobaczyƒá podglƒÖd
                        </div>
                    `;
                    return;
                }

                const typeEmoji = Helpers.getQuestionTypeEmoji(type);
                const typeName = this.getQuestionTypeName(type);
                const stars = '‚òÖ'.repeat(difficulty) + '‚òÜ'.repeat(5 - difficulty);

                let contentHtml = '';

                if (AppState.editingImageData) {
                    contentHtml += `<img src="${AppState.editingImageData}" class="preview-image visible" alt="PodglƒÖd obrazu">`;
                }

                contentHtml += `<div class="preview-type"><span class="icon">${typeEmoji}</span> ${typeName}</div>`;

                if (text) {
                    contentHtml += `<div class="preview-question-text">${text}</div>`;
                }

                if (type === 'ordering') {
                    const options = this.getOptionsFromForm();
                    
                    if (options.length > 0) {
                        contentHtml += `<div class="preview-options">`;
                        options.forEach((opt, idx) => {
                            contentHtml += `
                                <div class="preview-option">
                                    <div class="preview-option-marker">${idx + 1}.</div>
                                    ${opt || '(opcja ' + (idx + 1) + ')'}
                                </div>
                            `;
                        });
                        contentHtml += `</div>`;
                    }
                } else if (type !== 'pairing') {
                    const options = this.getOptionsFromForm();
                    const correct = this.getCorrectFromForm();
                    
                    if (options.length > 0) {
                        contentHtml += `<div class="preview-options">`;
                        options.forEach((opt, idx) => {
                            const isCorrect = correct.includes(idx + 1);
                            const marker = String.fromCharCode(65 + idx);
                            const typeClass = type === 'single' ? 'single' : 'multiple';
                            contentHtml += `
                                <div class="preview-option ${typeClass} ${isCorrect ? 'correct' : ''}">
                                    <div class="preview-option-marker">${marker}</div>
                                    ${opt || '(opcja ' + (idx + 1) + ')'}
                                </div>
                            `;
                        });
                        contentHtml += `</div>`;
                    }
                } else {
                    const pairs = this.getPairsFromForm();
                    
                    if (pairs.length > 0) {
                        contentHtml += `<div class="preview-pairs">`;
                        pairs.forEach((pair, idx) => {
                            contentHtml += `
                                <div class="preview-pair">
                                    <div class="preview-pair-left">${pair.left || '(lewa ' + (idx + 1) + ')'}</div>
                                    <div class="preview-pair-arrow">‚Üí</div>
                                    <div class="preview-pair-right">${pair.right || '(prawa ' + (idx + 1) + ')'}</div>
                                </div>
                            `;
                        });
                        contentHtml += `</div>`;
                    }
                }

                if (category || tags.length > 0) {
                    contentHtml += `<div class="preview-meta">`;
                    if (category) {
                        contentHtml += `<span class="preview-badge category">${category}</span>`;
                    }
                    tags.forEach(tag => {
                        contentHtml += `<span class="preview-badge tag">#${tag}</span>`;
                    });
                    contentHtml += `</div>`;
                }

                if (explanation) {
                    contentHtml += `<div class="preview-explanation"><strong>Wyja≈õnienie:</strong> ${explanation}</div>`;
                }

                previewContent.innerHTML = `<div class="preview-card">${contentHtml}</div>`;
            }

            getOptionsFromForm() {
                const optionInputs = document.querySelectorAll('.option-text');
                return Array.from(optionInputs).map(input => input.value.trim());
            }

            getPairsFromForm() {
                const pairsContainer = document.getElementById('pairs-container');
                const pairs = pairsContainer.querySelectorAll('.pair-item');
                return Array.from(pairs).map(pairDiv => {
                    const inputs = pairDiv.querySelectorAll('input');
                    return {
                        left: inputs[0].value.trim(),
                        right: inputs[1].value.trim()
                    };
                });
            }

            validateForm() {
                this.clearErrors();
                const t = Translations[AppState.language];
                let isValid = true;

                const text = document.getElementById('question-text').value.trim();
                const category = document.getElementById('question-category').value.trim();
                const type = document.getElementById('question-type').value;

                if (!text) {
                    document.getElementById('error-question-text').textContent = t.error_text_required;
                    isValid = false;
                }

                if (!category) {
                    document.getElementById('error-question-category').textContent = t.error_category_required;
                    isValid = false;
                }

                if (type === 'pairing') {
                    const pairs = document.getElementById('pairs-container').querySelectorAll('.pair-item');
                    if (pairs.length === 0) {
                        document.getElementById('error-pairs').textContent = t.error_min_pairs;
                        isValid = false;
                    }
                } else {
                    const options = document.querySelectorAll('.option-text');
                    const correct = this.getCorrectFromForm();

                    if (options.length < 2) {
                        document.getElementById('error-options').textContent = t.error_min_options;
                        isValid = false;
                    }

                    if (correct.length === 0 && type !== 'ordering') {
                        document.getElementById('error-options').textContent = t.error_min_correct;
                        isValid = false;
                    }
                }

                return isValid;
            }

            saveQuestion(saveAndNew = false) {
                if (!this.validateForm()) {
                    return;
                }

                const id = document.getElementById('question-id').value;
                const type = document.getElementById('question-type').value;
                const text = document.getElementById('question-text').value.trim();
                const category = document.getElementById('question-category').value.trim();
                const explanation = document.getElementById('question-explanation').value.trim();
                const difficulty = parseInt(document.getElementById('question-difficulty').value);
                const tagsContainer = document.getElementById('question-tags-container');
                const tags = Array.from(tagsContainer.querySelectorAll('.tag-chip')).map(chip => 
                    chip.textContent.replace('√ó', '').trim()
                );

                let options = [];
                let correct = [];
                let pairs = [];

                if (type === 'pairing') {
                    const pairsContainer = document.getElementById('pairs-container');
                    const pairItems = pairsContainer.querySelectorAll('.pair-item');
                    pairs = Array.from(pairItems).map(pairDiv => {
                        const inputs = pairDiv.querySelectorAll('input');
                        return {
                            left: inputs[0].value.trim(),
                            right: inputs[1].value.trim()
                        };
                    });
                } else {
                    const optionInputs = document.querySelectorAll('.option-text');
                    options = Array.from(optionInputs).map(input => input.value.trim());
                    
                    if (type === 'ordering') {
                        correct = options.map((_, index) => index + 1);
                    } else {
                        correct = this.getCorrectFromForm();
                    }
                }

                const t = Translations[AppState.language];

                if (id) {
                    const index = AppState.questions.findIndex(q => q.id === id);
                    if (index !== -1) {
                        AppState.questions[index] = {
                            ...AppState.questions[index],
                            type,
                            text,
                            category,
                            explanation,
                            difficulty,
                            tags,
                            options,
                            correct,
                            pairs,
                            imageData: AppState.editingImageData || ''
                        };
                        this.showToast('success', t.toast_success, t.question_updated);
                    }
                } else {
                    const newQuestion = new Question({
                        type,
                        text,
                        category,
                        explanation,
                        difficulty,
                        tags,
                        options,
                        correct,
                        pairs,
                        imageData: AppState.editingImageData || ''
                    });
                    AppState.questions.unshift(newQuestion);
                    this.showToast('success', t.toast_success, t.question_saved);
                }

                this.saveQuestions();
                this.updateUI();

                if (saveAndNew) {
                    this.resetForm();
                } else {
                    this.navigateTo('questions');
                }
            }

            copyQuestion(id) {
                const question = AppState.questions.find(q => q.id === id);
                if (question) {
                    const newQuestion = new Question({
                        ...question
                    });
                    newQuestion.id = Helpers.generateId();
                    newQuestion.text = `${newQuestion.text} (copy)`;
                    AppState.questions.unshift(newQuestion);
                    this.saveQuestions();
                    this.updateUI();
                    this.showToast('success', this.t('toast_success'), this.t('copy_success'));
                }
            }

            deleteQuestion(id) {
                const t = Translations[AppState.language];
                if (confirm(t.delete_confirm)) {
                    AppState.questions = AppState.questions.filter(q => q.id !== id);
                    this.saveQuestions();
                    this.updateUI();
                    this.showToast('success', t.toast_success, t.delete_success);
                }
            }

            // ==================== LANGUAGE ====================
            setLanguage(lang) {
                console.log('setLanguage() called with:', lang);
                AppState.language = lang;
                localStorage.setItem('language', lang);

                // Update language switcher UI
                document.getElementById('lang-pl').classList.toggle('active', lang === 'pl');
                document.getElementById('lang-en').classList.toggle('active', lang === 'en');

                // Update all UI text
                this.updateAllText();

                console.log(`Language switched to: ${lang}`);
                console.log('AppState.language after switch:', AppState.language);
            }

            // ==================== UPDATE ALL TEXT ====================
            updateAllText() {
                const t = Translations[AppState.language];
                console.log('updateAllText() called, language:', AppState.language);

                // Helper function to safely get element
                const safeGetElement = (selector) => {
                    const element = document.querySelector(selector);
                    if (!element) {
                        console.warn(`Element not found: ${selector}`);
                    }
                    return element;
                };

                // Helper function to safely set text content
                const safeSetText = (element, text) => {
                    if (element) {
                        element.textContent = text;
                    }
                };

                // Helper function to safely set HTML content
                const safeSetHTML = (element, html) => {
                    if (element) {
                        element.innerHTML = html;
                    }
                };

                // Update sidebar navigation
                const navLinks = document.querySelectorAll('.nav-link');
                if (navLinks.length > 0) {
                    navLinks.forEach(link => {
                        const page = link.getAttribute('data-page');
                        const textSpan = link.lastChild;

                        if (page === 'questions') {
                            safeSetText(textSpan, t.nav_questions);
                        } else if (page === 'create') {
                            safeSetText(textSpan, t.nav_create);
                        } else if (page === 'import-export') {
                            safeSetText(textSpan, t.nav_import_export);
                        } else if (page === 'help') {
                            safeSetText(textSpan, t.nav_help);
                        }
                    });
                }

                // Update questions page
                safeSetText(safeGetElement('#questions-page .card-title'), t.list_title);
                safeSetHTML(safeGetElement('#questions-page #add-question-btn'), `<span class="icon">‚ûï</span> ${t.add_question}`);
                safeSetText(safeGetElement('#empty-state .empty-title'), t.empty_title);
                safeSetText(safeGetElement('#empty-state p'), t.empty_text);
                safeSetHTML(safeGetElement('#empty-state .btn-primary'), `<span class="icon">üì•</span> ${t.import_btn}`);

                // Update stats labels
                safeSetText(safeGetElement('#stat-single').nextElementSibling, t.stats_single);
                safeSetText(safeGetElement('#stat-multiple').nextElementSibling, t.stats_multiple);
                safeSetText(safeGetElement('#stat-ordering').nextElementSibling, t.stats_ordering);
                safeSetText(safeGetElement('#stat-pairing').nextElementSibling, t.stats_pairing);
                safeSetText(safeGetElement('#stat-total').nextElementSibling, t.stats_total);

                // Re-render questions with new language
                this.renderQuestions();

                // Update pagination text
                this.renderPagination();

                // Update create page
                const editorTitle = safeGetElement('#editor-title');
                if (editorTitle) {
                    safeSetText(editorTitle, AppState.editingQuestionId ? t.editor_title_edit : t.editor_title_new);
                }
                safeSetText(safeGetElement('#cancel-btn'), t.cancel_btn);
                safeSetHTML(safeGetElement('#save-btn'), `<span class="icon">üíæ</span> ${t.save_btn}`);
                const saveNewBtn = safeGetElement('#save-new-btn');
                if (saveNewBtn) {
                    saveNewBtn.innerHTML = `<span class="icon">‚ûï</span> ${t.save_new_btn}`;
                }

                // Update editor form labels
                safeSetText(safeGetElement('label[for="question-type"]'), t.label_type);
                safeSetText(safeGetElement('label[for="question-text"]'), t.label_text + ' <span class="required">*</span>');
                const textInput = safeGetElement('#question-text');
                if (textInput) textInput.placeholder = t.placeholder_text;
                safeSetText(safeGetElement('label[for="question-category"]'), t.label_category + ' <span class="required">*</span>');
                const categoryInput = safeGetElement('#question-category');
                if (categoryInput) categoryInput.placeholder = t.placeholder_category;
                safeSetText(safeGetElement('label[for="question-tags"]'), t.label_tags);
                const tagsInput = safeGetElement('#question-tags-input');
                if (tagsInput) tagsInput.placeholder = t.placeholder_tags;
                safeSetText(safeGetElement('label[for="question-difficulty"]'), t.label_difficulty);
                safeSetText(safeGetElement('label[for="question-explanation"]'), t.label_explanation);
                const explanationInput = safeGetElement('#question-explanation');
                if (explanationInput) explanationInput.placeholder = t.placeholder_explanation;

                // Update buttons
                const addOptionBtn = safeGetElement('#add-option-btn');
                if (addOptionBtn) {
                    addOptionBtn.innerHTML = `<span class="icon">‚ûï</span> ${t.add_option}`;
                }
                const addPairBtn = safeGetElement('#add-pair-btn');
                if (addPairBtn) {
                    addPairBtn.innerHTML = `<span class="icon">‚ûï</span> ${t.add_pair}`;
                }

                // Update import/export page
                safeSetText(safeGetElement('#import-export-page .card-title'), t.nav_import_export);
                safeSetText(safeGetElement('#import-label'), t.import_title);
                const importDesc = safeGetElement('#import-description');
                if (importDesc) {
                    importDesc.textContent = t.import_label;
                }
                safeSetText(safeGetElement('#export-label'), t.export_title);
                const exportDesc = safeGetElement('#export-description');
                if (exportDesc) {
                    exportDesc.textContent = t.export_text;
                }
                safeSetHTML(safeGetElement('#export-btn'), `<span class="icon">üì§</span> ${t.export_btn}`);

                // Update help page
                safeSetText(safeGetElement('#help-page .card-title'), t.help_title);
                const helpP = safeGetElement('#help-page p');
                if (helpP) {
                    helpP.innerHTML = `<strong>${t.app_version}</strong><br>${t.app_desc}`;
                }
                const typeH3 = safeGetElement('#help-page h3');
                if (typeH3) {
                    typeH3.textContent = t.supported_types;
                }
                const featuresH3 = typeH3?.nextElementSibling?.nextElementSibling;
                if (featuresH3) {
                    featuresH3.textContent = t.features_title;
                }

                // Update footer status
                const statusP = safeGetElement('#help-page .text-secondary.mt-4');
                if (statusP) {
                    statusP.innerHTML = `<strong>${t.status_label}</strong> ${t.status_0_8_0}<br><strong>${t.progress_0_8_0}</strong>`;
                }

                console.log('updateAllText() completed');
            }

            // ==================== GET TEXT HELPER ====================
            t(key) {
                return Translations[AppState.language][key] || key;
            }

            getQuestionTypeName(type) {
                const t = Translations[AppState.language];
                switch (type) {
                    case 'single':
                        return t.type_single;
                    case 'multiple':
                        return t.type_multiple;
                    case 'ordering':
                        return t.type_ordering;
                    case 'pairing':
                        return t.type_pairing;
                    default:
                        return type;
                }
            }

            // ==================== FILTERS LOGIC ====================
            onFilterSearchChange(event) {
                const searchValue = event.target.value.trim();
                AppState.filterSearch = searchValue;
                this.renderQuestions();
                console.log(`Filter search: "${searchValue}"`);
            }

            onFilterTypeChange() {
                const typeValue = document.getElementById('filter-type').value;
                AppState.filterType = typeValue;
                this.renderQuestions();
                console.log(`Filter type: "${typeValue}"`);
            }

            onFilterCategoryChange() {
                const categoryValue = document.getElementById('filter-category').value;
                AppState.filterCategory = categoryValue;
                this.renderQuestions();
                console.log(`Filter category: "${categoryValue}"`);
            }

            onAddTag(tag) {
                if (!AppState.filterTags.includes(tag)) {
                    AppState.filterTags.push(tag);
                    this.renderFilterTags();
                    this.renderQuestions();
                console.log(`Tag added: ${tag}`);
                }
            }

            onRemoveTag(tag) {
                AppState.filterTags = AppState.filterTags.filter(t => t !== tag);
                this.renderFilterTags();
                this.renderQuestions();
                console.log(`Tag removed: ${tag}`);
            }

            // ==================== RENDER FILTER TAGS ====================
            renderFilterTags() {
                const tagsContainer = document.getElementById('filter-tags-container');
                if (!tagsContainer) return;

                const tags = [...new Set(AppState.questions.flatMap(q => q.tags || []))];
                const currentTags = AppState.filterTags;

                // Clear container
                tagsContainer.innerHTML = '';

                tags.forEach(tag => {
                    const isSelected = currentTags.includes(tag);
                    const chipClass = isSelected ? 'chip active' : 'chip';

                    const chip = document.createElement('div');
                    chip.className = `chip ${chipClass}`;
                    chip.textContent = tag;
                    chip.onclick = () => this.onRemoveTag(tag);

                    tagsContainer.appendChild(chip);
                });
            }

            // ==================== UPDATE FILTERS UI ====================
            updateFiltersUI() {
                const t = Translations[AppState.language];

                // Update search placeholder
                const searchInput = document.getElementById('filter-search');
                if (searchInput) {
                    searchInput.placeholder = t.search_placeholder;
                }

                // Update type dropdown
                const typeFilter = document.getElementById('filter-type');
                if (typeFilter) {
                    typeFilter.value = AppState.filterType;
                }

                // Update category dropdown
                const categoryFilter = document.getElementById('filter-category');
                if (categoryFilter) {
                    categoryFilter.innerHTML = `<option value="all">${t.filter_category_all}</option>`;
                    const categories = [...new Set(AppState.questions.map(q => q.category).filter(c => c && c.trim() !== ''))];
                    categories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        if (cat === AppState.filterCategory) {
                            option.selected = true;
                        }
                        categoryFilter.appendChild(option);
                    });
                }

                // Render tags
                this.renderFilterTags();
            }

            // ==================== RESET FILTERS ====================
            resetFilters() {
                console.log('resetFilters() called');

                // Clear all filters
                AppState.filterSearch = '';
                AppState.filterType = 'all';
                AppState.filterCategory = '';
                AppState.filterTags = [];

                // Update UI
                this.updateFiltersUI();

                // Re-render questions with cleared filters
                this.renderQuestions();
                console.log('Filters reset, all questions shown');
            }

            // ==================== IMPORT/EXPORT ====================
            exportQuestions() {
                const t = Translations[AppState.language];
                
                const exportData = {
                    version: '2.11.0',
                    exportDate: new Date().toISOString(),
                    category: 'all',
                    totalQuestions: AppState.questions.length,
                    questions: AppState.questions.map(q => q.toJson())
                };

                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `quiz_questions_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                this.showToast('success', t.toast_success, t.export_success);
            }

            handleImport(data) {
                const t = Translations[AppState.language];

                const validation = this.validateImportData(data);
                if (!validation.isValid) {
                    this.showToast('error', t.toast_error, validation.message);
                    return;
                }

                const importCount = validation.questions.length;

                if (AppState.questions.length > 0 && importCount > 0) {
                    const merge = confirm(t.import_merge_confirm.replace('{count}', importCount));
                    if (merge) {
                        this.mergeQuestions(validation.questions);
                        this.showToast('success', t.toast_success, t.import_merge_success.replace('{count}', importCount));
                    } else {
                        this.showToast('warning', t.toast_warning, t.import_cancelled);
                    }
                } else {
                    AppState.questions = validation.questions;
                    this.saveQuestions();
                    this.updateUI();
                    this.showToast('success', t.toast_success, t.import_success.replace('{count}', importCount));
                }

                document.getElementById('import-file').value = '';
            }

            validateImportData(data) {
                const t = Translations[AppState.language];
                
                if (!data || typeof data !== 'object') {
                    return { isValid: false, message: t.import_error_invalid };
                }

                let questions = [];

                if (Array.isArray(data)) {
                    questions = data;
                } else if (data.questions && Array.isArray(data.questions)) {
                    questions = data.questions;
                } else {
                    return { isValid: false, message: t.import_error_no_questions };
                }

                const validQuestions = [];
                const errors = [];

                questions.forEach((q, idx) => {
                    try {
                        const question = Question.fromJson(q);
                        validQuestions.push(question);
                    } catch (error) {
                        errors.push(`Question ${idx + 1}: ${error.message}`);
                    }
                });

                if (validQuestions.length === 0) {
                    return { isValid: false, message: t.import_error_no_valid };
                }

                if (errors.length > 0) {
                    console.warn('Import errors:', errors);
                }

                return { isValid: true, questions: validQuestions, errors };
            }

            mergeQuestions(newQuestions) {
                const existingIds = new Set(AppState.questions.map(q => q.id));
                const mergedQuestions = [];

                newQuestions.forEach(q => {
                    if (!existingIds.has(q.id)) {
                        mergedQuestions.push(q);
                    }
                });

                AppState.questions = [...AppState.questions, ...mergedQuestions];
                this.saveQuestions();
                this.updateUI();
            }

            exportToClipboard() {
                const t = Translations[AppState.language];

                const exportData = {
                    version: '2.11.0',
                    exportDate: new Date().toISOString(),
                    category: 'all',
                    totalQuestions: AppState.questions.length,
                    questions: AppState.questions.map(q => q.toJson())
                };

                const dataStr = JSON.stringify(exportData, null, 2);

                navigator.clipboard.writeText(dataStr).then(() => {
                    this.showToast('success', t.toast_success, t.clipboard_copy_success);
                }).catch((error) => {
                    this.showToast('error', t.toast_error, t.clipboard_copy_failed);
                });
            }

            importFromClipboard() {
                const t = Translations[AppState.language];

                navigator.clipboard.readText().then((text) => {
                    try {
                        const data = JSON.parse(text);
                        this.handleImport(data);
                    } catch (error) {
                        this.showToast('error', t.toast_error, t.import_error_invalid);
                    }
                }).catch((error) => {
                    this.showToast('error', t.toast_error, t.clipboard_read_failed);
                });
            }

            // ==================== TOAST NOTIFICATIONS ====================
            showToast(type, title, message) {
                const container = document.getElementById('toast-container');
                if (!container) return;

                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <div class="toast-content">
                        <div class="toast-title">${title}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close" onclick="this.parentElement.remove()">√ó</button>
                `;

                container.appendChild(toast);

                // Auto remove after 5 seconds
                setTimeout(() => {
                    if (toast.parentElement) {
                        toast.style.animation = 'slideOut 0.3s ease';
                        setTimeout(() => toast.remove(), 300);
                    }
                }, 5000);
            }
        }

        // ==================== INITIALIZE APP ====================
        const app = new QuizEditorApp();

        console.log('Quiz Question Editor v0.8.0 loaded successfully!');
        console.log('Language:', AppState.language);
        console.log('Progress: 80% of implementation plan');
    </script>
</body>
</html>
